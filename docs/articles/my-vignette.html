<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Introduction to EpiCyst &bull; EPICYST</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">EPICYST</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Introduction to EpiCyst</h1>
                        <h4 class="author">Peter Winskill</h4>
            
            <h4 class="date">2016-12-21</h4>
          </div>

    
    
<div class="contents">
<div id="call-and-view-default-parameters-and-equilibrium-solutions" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#call-and-view-default-parameters-and-equilibrium-solutions" class="anchor"> </a></body></html>Call and view default parameters and equilibrium solutions</h1>
<p>The <code><a href="../reference/Set_up.html">Set_up()</a></code> function provides the user a means to specify parameters and starting conditions for a model run. Input parameters, as well as starting prevalence for Taeniasis, and Cysticercosis (in the porcine and human populations) may be left at the default values or specified in the function call.</p>
<p>Changes to default prevalence values will initiate to re-estimation of transmission parameters to allow the system to run at the newly specified endemic equilibrium. The <code><a href="../reference/Set_up.html">Set_up()</a></code> function returns a list of two elements: 1) The input parameters for a model run (standardised time units and dependent parameters included) and 2) Initial state variable values.</p>
<p>To initiate and view default parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">Initialise&lt;-<span class="kw"><a href="../reference/Set_up.html">Set_up</a></span>()</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># View parameters</span>
Initialise[[<span class="dv">1</span>]][<span class="dv">1</span>:<span class="dv">5</span>]</code></pre></div>
<pre><code>## $tau
## [1] 2.357443e-10
## 
## $PPS
## [1] 2000
## 
## $HPS
## [1] 10000
## 
## $bH
## [1] 15.4321
## 
## $bP
## [1] 166.6667</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># View state variable starting values</span>
Initialise[[<span class="dv">2</span>]][<span class="dv">6</span>:<span class="dv">7</span>]</code></pre></div>
<pre><code>## $IH0
## [1] 186
## 
## $IPL0
## [1] 320</code></pre>
<p>Input arguments for <code><a href="../reference/Set_up.html">Set_up()</a></code> are documented in the help file <code><a href="../reference/Set_up.html">?Set_up()</a></code>. Certain combinations of input prevalence may not be possible to fit, in which case an error message will be thrown.</p>
</div>
<div id="run-the-model-with-no-interventions" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#run-the-model-with-no-interventions" class="anchor"> </a></body></html>Run the model with no interventions</h1>
<p>The <code><a href="../reference/Run_model.html">Run_model()</a></code> function provides all functionality for model runs. To run the model at baseline, with default parameters and endemic equilibrium values, only the length of the model run (specified in years) need be specified:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">M1&lt;-<span class="kw"><a href="../reference/Run_model.html">Run_model</a></span>(<span class="dt">Time=</span><span class="dv">50</span>)</code></pre></div>
<table class="table"><caption>State variables</caption>
<thead><tr class="header"><th align="right">t</th>
<th align="right">SH</th>
<th align="right">IH</th>
<th align="right">SHC</th>
<th align="right">IHC</th>
<th align="right">E</th>
<th align="right">SP</th>
<th align="right">IPL</th>
<th align="right">IPH</th>
<th align="right">RP</th>
<th align="right">VP</th>
</tr></thead><tbody><tr class="odd"><td align="right">0.0000000</td>
<td align="right">9114.000</td>
<td align="right">186.0000</td>
<td align="right">686.0000</td>
<td align="right">14.00000</td>
<td align="right">88372603</td>
<td align="right">1600</td>
<td align="right">320</td>
<td align="right">80</td>
<td align="right">0</td>
<td align="right">0</td>
</tr><tr class="even"><td align="right">0.0333333</td>
<td align="right">9114.015</td>
<td align="right">185.9852</td>
<td align="right">685.9852</td>
<td align="right">14.01476</td>
<td align="right">88372603</td>
<td align="right">1600</td>
<td align="right">320</td>
<td align="right">80</td>
<td align="right">0</td>
<td align="right">0</td>
</tr><tr class="odd"><td align="right">0.0666667</td>
<td align="right">9114.030</td>
<td align="right">185.9705</td>
<td align="right">685.9705</td>
<td align="right">14.02947</td>
<td align="right">88372602</td>
<td align="right">1600</td>
<td align="right">320</td>
<td align="right">80</td>
<td align="right">0</td>
<td align="right">0</td>
</tr><tr class="even"><td align="right">0.1000000</td>
<td align="right">9114.044</td>
<td align="right">185.9558</td>
<td align="right">685.9558</td>
<td align="right">14.04415</td>
<td align="right">88372601</td>
<td align="right">1600</td>
<td align="right">320</td>
<td align="right">80</td>
<td align="right">0</td>
<td align="right">0</td>
</tr><tr class="odd"><td align="right">0.1333333</td>
<td align="right">9114.059</td>
<td align="right">185.9411</td>
<td align="right">685.9412</td>
<td align="right">14.05880</td>
<td align="right">88372598</td>
<td align="right">1600</td>
<td align="right">320</td>
<td align="right">80</td>
<td align="right">0</td>
<td align="right">0</td>
</tr></tbody></table><table class="table"><caption>Cumulative cases</caption>
<thead><tr class="header"><th align="right">CCC</th>
<th align="right">CTC</th>
</tr></thead><tbody><tr class="odd"><td align="right">0.0000000</td>
<td align="right">0.0000000</td>
</tr><tr class="even"><td align="right">0.6841558</td>
<td align="right">0.3010288</td>
</tr><tr class="odd"><td align="right">1.3683106</td>
<td align="right">0.6020576</td>
</tr><tr class="even"><td align="right">2.0524643</td>
<td align="right">0.9030864</td>
</tr><tr class="odd"><td align="right">2.7366170</td>
<td align="right">1.2041152</td>
</tr></tbody></table><table class="table"><caption>Tracked cases</caption>
<thead><tr class="header"><th align="right">Humans_Taeniasis</th>
<th align="right">Humans_Cysticercosis</th>
<th align="right">Pigs_Cysticercosis</th>
</tr></thead><tbody><tr class="odd"><td align="right">200</td>
<td align="right">700</td>
<td align="right">400</td>
</tr><tr class="even"><td align="right">200</td>
<td align="right">700</td>
<td align="right">400</td>
</tr><tr class="odd"><td align="right">200</td>
<td align="right">700</td>
<td align="right">400</td>
</tr><tr class="even"><td align="right">200</td>
<td align="right">700</td>
<td align="right">400</td>
</tr><tr class="odd"><td align="right">200</td>
<td align="right">700</td>
<td align="right">400</td>
</tr></tbody></table><table class="table"><caption>Tracked prevalence</caption>
<thead><tr class="header"><th align="right">Human_Taeniasis_prev</th>
<th align="right">Human_Cysticercosis_prev</th>
<th align="right">Pig_Cysticercosis_prev</th>
</tr></thead><tbody><tr class="odd"><td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr><tr class="even"><td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr><tr class="odd"><td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr><tr class="even"><td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr><tr class="odd"><td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr></tbody></table><p>It is suggested that a period of burn in (specified in years) is included to ensure small changes in endemic equilibrium at the start of a run are avoided:</p>
<pre><code>M2&lt;-Run_model(Time=50, Burn_in=25)</code></pre>
<p>Model output starts after this burn in period.</p>
<p>The model can be run with different starting parameters or endemic prevalences. For example to run the model with an prevalence of Taeniasis of 4%:</p>
<pre><code># Set up the model, specifying the new Taeniasis prevalence
S1&lt;-Set_up(TPREV=0.04)
# Run the model, with new input parameters and initial conditions
M3&lt;-Run_model(Time=50, Burn_in=25, Params=S1[[1]], Initial_states=S1[[2]])</code></pre>
<p>Model runs return a <code>data.frame</code> of model output for each time step.</p>
</div>
<div id="call-and-view-intervention-effects" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#call-and-view-intervention-effects" class="anchor"> </a></body></html>Call and view intervention effects</h1>
<p>The intervention effect sizes can be viewed using the <code><a href="../reference/Intervention_effect_size.html">Intervention_effect_size()</a></code> function. Effect sizes can be modified if required:</p>
<pre><code># Initialise default intervention effect sizes
E1&lt;-Intervention_effect_size()
# Double the effect size of Husbandry
E1$$Husbandry&lt;-0.6</code></pre>
</div>
<div id="run-the-model-with-interventions" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#run-the-model-with-interventions" class="anchor"> </a></body></html>Run the model with intervention(s)</h1>
<p>The model can be run with a number of interventions. These include:</p>
<ol style="list-style-type: decimal"><li>Sanitation</li>
<li>Husbandry</li>
<li>Meat inspection</li>
<li>Human test and treat</li>
<li>Pig MDA</li>
<li>Pig vaccination</li>
</ol><p>Running the model, with default intervention effect sizes, requires the intervention and implementation time (year) to be specified:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">I1&lt;-<span class="kw"><a href="../reference/Run_model.html">Run_model</a></span>(<span class="dt">Time=</span><span class="dv">50</span>, <span class="dt">Burn_in=</span><span class="dv">50</span>, <span class="dt">Intervention=</span><span class="st">'Sanitation'</span>, <span class="dt">Intervention_time=</span><span class="dv">25</span>)</code></pre></div>
<p>Multiple interventions may be implemented by provision of a vector:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">I2&lt;-<span class="kw"><a href="../reference/Run_model.html">Run_model</a></span>(<span class="dt">Time=</span><span class="dv">50</span>, <span class="dt">Burn_in=</span><span class="dv">25</span>, 
              <span class="dt">Intervention=</span><span class="kw">c</span>(<span class="st">'Sanitation'</span>, <span class="st">'Human_test_and_treat'</span>, <span class="st">'Pig_vaccine'</span>),
              <span class="dt">Intervention_time=</span><span class="dv">25</span>)</code></pre></div>
<p>Intervention options are detailed in the function help <code><a href="../reference/Run_model.html">?Run_model</a></code>. At present all interventions are implemented at the same time.</p>
</div>
<div id="visualising-output" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#visualising-output" class="anchor"> </a></body></html>Visualising output</h1>
<p>The model output data.frame facilitates visualisation using general base <code>R</code> or other plotting methods (eg <code>ggplot2</code>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Run the baseline model:</span>
M1&lt;-<span class="kw"><a href="../reference/Run_model.html">Run_model</a></span>(<span class="dt">Time=</span><span class="dv">50</span>, <span class="dt">Burn_in=</span><span class="dv">50</span>)
<span class="co"># Run the model with a single intervention:</span>
M2&lt;-<span class="kw"><a href="../reference/Run_model.html">Run_model</a></span>(<span class="dt">Time=</span><span class="dv">50</span>, <span class="dt">Intervention=</span><span class="st">'Sanitation'</span>, <span class="dt">Intervention_time=</span><span class="dv">20</span>, <span class="dt">Burn_in=</span><span class="dv">50</span>)
<span class="co"># Run the model with multiple interventions:</span>
M3&lt;-<span class="kw"><a href="../reference/Run_model.html">Run_model</a></span>(<span class="dt">Time=</span><span class="dv">50</span>, <span class="dt">Intervention=</span><span class="kw">c</span>(<span class="st">'Human_test_and_treat'</span>, <span class="st">'Pig_MDA'</span>), 
                  <span class="dt">Intervention_time=</span><span class="dv">20</span>, <span class="dt">Burn_in=</span><span class="dv">50</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Plot the output in base R</span>
<span class="kw">plot</span>(M1$t/<span class="dv">12</span>, M1$Humans_Cysticercosis, <span class="dt">t=</span><span class="st">'l'</span>, <span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="dt">ylab=</span><span class="st">'Humans with Cysticercosis'</span>, <span class="dt">xlab=</span><span class="st">'Time (years)'</span>)
<span class="kw">lines</span>(M2$t/<span class="dv">12</span>, M2$Humans_Cysticercosis, <span class="dt">col=</span><span class="st">'deeppink'</span>)
<span class="kw">lines</span>(M3$t/<span class="dv">12</span>, M3$Humans_Cysticercosis, <span class="dt">col=</span><span class="st">'dodgerblue'</span>)
<span class="kw">legend</span>(<span class="st">'topright'</span>, <span class="kw">c</span>(<span class="st">'Baseline'</span>,<span class="st">'Sanitation'</span>,<span class="st">'Human test &amp; treat and Pig MDA'</span>), <span class="dt">lty=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),
           <span class="dt">col=</span><span class="kw">c</span>(<span class="st">'black'</span>,<span class="st">'deeppink'</span>, <span class="st">'dodgerblue'</span>))</code></pre></div>
<p><img src="my-vignette_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="r0" class="section level1">
<h1 class="hasAnchor"><html><body><a href="#r0" class="anchor"> </a></body></html>R0</h1>
<p>The next-generation matrix estimate of the basic reproduction number (R0) for a given parameters set can be estimated:</p>
<pre><code><a href="../reference/R0.html">R0(Params=Set_up()[[1]])</a></code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#call-and-view-default-parameters-and-equilibrium-solutions">Call and view default parameters and equilibrium solutions</a></li>
      <li><a href="#run-the-model-with-no-interventions">Run the model with no interventions</a></li>
      <li><a href="#call-and-view-intervention-effects">Call and view intervention effects</a></li>
      <li><a href="#run-the-model-with-interventions">Run the model with intervention(s)</a></li>
      <li><a href="#visualising-output">Visualising output</a></li>
      <li><a href="#r0">R0</a></li>
      </ul></div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Peter Winskill.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
